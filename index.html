<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aldonia Comprehensive Platform | Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #4f46e5; --bg: #f8fafc; --card: #ffffff; --text: #1e293b; }
        body.theme-dark { --primary: #818cf8; --bg: #0f172a; --card: #1e293b; --text: #f1f5f9; }
        body.theme-royal { --primary: #b45309; --bg: #fffbeb; --card: #ffffff; --text: #78350f; }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: var(--text); transition: 0.3s ease; }

        nav { background: var(--card); padding: 1rem 5%; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        .nav-btn { padding: 8px 15px; border-radius: 10px; border: none; cursor: pointer; background: rgba(0,0,0,0.05); color: var(--text); font-weight: bold; }
        .nav-btn.active { background: var(--primary); color: white; }

        .container { max-width: 1100px; margin: 2rem auto; padding: 0 1rem; }
        .card { background: var(--card); border-radius: 20px; padding: 1.5rem; box-shadow: 0 10px 25px rgba(0,0,0,0.05); margin-bottom: 1.5rem; border: 1px solid rgba(0,0,0,0.05); }

        input, select { width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; margin-top: 8px; background: var(--card); color: var(--text); }
        .btn { background: var(--primary); color: white; border: none; padding: 12px; border-radius: 12px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 10px; }
        .btn-del { background: #fee2e2; color: #ef4444; border: none; padding: 5px 10px; border-radius: 8px; cursor: pointer; }

        .list-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Quiz & AI Styles */
        .chat-box { height: 120px; overflow-y: auto; background: rgba(0,0,0,0.02); padding: 10px; border-radius: 10px; margin-bottom: 10px; font-size: 0.9rem; }
        .quiz-opt { padding: 10px; background: rgba(0,0,0,0.03); border-radius: 10px; margin-top: 5px; cursor: pointer; border: 2px solid transparent; }
        .quiz-opt.selected { border-color: var(--primary); background: rgba(79, 70, 229, 0.1); }
    </style>
</head>
<body id="mainBody">

    <nav>
        <div style="font-weight: 900; color: var(--primary); font-size: 1.3rem;">ALDONIA ACADEMY</div>
        <div>
            <button class="nav-btn active" onclick="showTab('stTab')">Ø§Ù„Ø·Ø§Ù„Ø¨</button>
            <button class="nav-btn" onclick="showTab('adTab')">Ø§Ù„Ù…Ø¯ÙŠØ±</button>
        </div>
    </nav>

    <div class="container">
        <div id="stTab" class="tab-content active">
            <div id="stLogin" class="card" style="max-width: 400px; margin: auto; text-align: center;">
                <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
                <input type="text" id="stNameIn" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
                <button class="btn" onclick="loginStudent()">Ø¯Ø®ÙˆÙ„</button>
            </div>

            <div id="stDash" style="display: none;">
                <div class="card" style="background: var(--primary); color: white;">
                    <h2 id="helloSt"></h2>
                    <p id="stPrivateNote"></p>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                    <div class="card">
                        <h3>ğŸ‘¨â€ğŸ« Ù…Ø¹Ù„Ù…ÙˆÙƒ</h3>
                        <div id="stTeachersList"></div>
                    </div>
                    <div class="card">
                        <h3>ğŸ¤– Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
                        <div id="aiChat" class="chat-box">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ!</div>
                        <input type="text" id="aiQuery" placeholder="Ø§Ø³Ø£Ù„Ù†ÙŠ..">
                        <button class="btn" onclick="talkToAI()">Ø¥Ø±Ø³Ø§Ù„</button>
                    </div>
                </div>

                <div class="card" id="quizArea">
                    <h3>ğŸ“ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙŠÙˆÙ…</h3>
                    <div id="qContent"><p id="qText">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø©.</p><div id="qOpts"></div><button class="btn" id="nextQBtn" style="display:none" onclick="nextQuestion()">Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ</button></div>
                    <div id="quizResult" style="display:none; text-align:center;"><h3 id="resScore"></h3><button class="btn" onclick="resetQuiz()">Ø¥Ø¹Ø§Ø¯Ø©</button></div>
                </div>
            </div>
        </div>

        <div id="adTab" class="tab-content">
            <div id="adLogin" class="card" style="max-width: 400px; margin: auto;">
                <h3>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ğŸ”</h3>
                <input type="password" id="adPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                <button class="btn" onclick="loginAdmin()">ØªØ­Ù‚Ù‚</button>
            </div>

            <div id="adPanel" style="display: none;">
                <div class="card">
                    <h4>ğŸ¨ Ø§Ù„Ù…Ø¸Ù‡Ø±: <button onclick="changeTheme('theme-dark')">Ù„ÙŠÙ„ÙŠ</button> <button onclick="changeTheme('theme-royal')">Ù…Ù„ÙƒÙŠ</button> <button onclick="changeTheme('')">Ø£Ø³Ø§Ø³ÙŠ</button></h4>
                </div>

                <div class="card">
                    <h4>ğŸ‘¨â€ğŸ« Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†</h4>
                    <div style="display: flex; gap: 5px;">
                        <input type="text" id="tName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…">
                        <input type="text" id="tSub" placeholder="Ø§Ù„Ù…Ø§Ø¯Ø©">
                        <button class="btn" style="width: 100px; margin:0" onclick="addTeacher()">Ø¥Ø¶Ø§ÙØ©</button>
                    </div>
                    <div id="adTeachersList" style="margin-top: 10px;"></div>
                </div>

                <div class="card">
                    <h4>ğŸ‘¥ Ø§Ù„Ø·Ù„Ø§Ø¨: <div id="adStList"></div></h4>
                </div>

                <div id="editBox" class="card" style="display:none; background:#fffbeb">
                    <h4>ØªØ®ØµÙŠØµ Ù„Ù€ <span id="targetSt"></span>:</h4>
                    <input type="text" id="p_sched" placeholder="Ø§Ù„Ù…ÙˆØ¹Ø¯"><button class="btn" onclick="savePrivate()">Ø­ÙØ¸</button>
                </div>

                <div class="card">
                    <h4>â“ Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h4>
                    <input type="text" id="newQ" placeholder="Ø§Ù„Ø³Ø¤Ø§Ù„">
                    <input type="text" id="o1" placeholder="Ø®ÙŠØ§Ø± 1"> <input type="text" id="o2" placeholder="Ø®ÙŠØ§Ø± 2">
                    <select id="correctO"><option value="0">Ø®ÙŠØ§Ø± 1 ØµØ­</option><option value="1">Ø®ÙŠØ§Ø± 2 ØµØ­</option></select>
                    <button class="btn" onclick="addQuizQ()">Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„</button>
                </div>
                
                <button class="btn" style="background: #64748b;" onclick="location.reload()">Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </div>

    <script>
        const PASS = "AAAA1234";
        let curSt = "", qIdx = 0, score = 0, selected = null, editT = "";

        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // Student
        function loginStudent() {
            const n = document.getElementById('stNameIn').value; if(!n) return;
            curSt = n;
            let sts = JSON.parse(localStorage.getItem('sts') || '[]');
            if(!sts.includes(n)) sts.push(n); localStorage.setItem('sts', JSON.stringify(sts));
            document.getElementById('stLogin').style.display = 'none';
            document.getElementById('stDash').style.display = 'block';
            document.getElementById('helloSt').innerText = `Ø£Ù‡Ù„Ø§Ù‹ ${n}`;
            render();
        }

        function talkToAI() {
            const q = document.getElementById('aiQuery').value;
            const chat = document.getElementById('aiChat');
            chat.innerHTML += `<div>Ø£Ù†Øª: ${q}</div>`;
            setTimeout(() => { chat.innerHTML += `<div style="color:blue">AI: Ù†ØµÙŠØ­ØªÙŠ Ù„Ùƒ Ù‡ÙŠ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„ØµØ¹Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹!</div>`; }, 500);
        }

        // Admin
        function loginAdmin() {
            if(document.getElementById('adPass').value === PASS) {
                document.getElementById('adLogin').style.display='none';
                document.getElementById('adPanel').style.display='block';
                render();
            }
        }

        function addTeacher() {
            let ts = JSON.parse(localStorage.getItem('teachers') || '[]');
            ts.push({id: Date.now(), n: document.getElementById('tName').value, s: document.getElementById('tSub').value});
            localStorage.setItem('teachers', JSON.stringify(ts));
            render();
        }

        function delTeacher(id) {
            let ts = JSON.parse(localStorage.getItem('teachers') || '[]');
            localStorage.setItem('teachers', JSON.stringify(ts.filter(x => x.id !== id)));
            render();
        }

        function addQuizQ() {
            let qs = JSON.parse(localStorage.getItem('qs') || '[]');
            qs.push({text: document.getElementById('newQ').value, opts: [document.getElementById('o1').value, document.getElementById('o2').value], correct: document.getElementById('correctO').value});
            localStorage.setItem('qs', JSON.stringify(qs));
            alert("ØªÙ…!");
        }

        function render() {
            document.getElementById('mainBody').className = localStorage.getItem('theme') || '';
            const ts = JSON.parse(localStorage.getItem('teachers') || '[]');
            const sts = JSON.parse(localStorage.getItem('sts') || '[]');

            // Student View
            document.getElementById('stTeachersList').innerHTML = ts.map(t => `<div class="list-item">${t.n} (${t.s})</div>`).join('');
            if(curSt) {
                const p = JSON.parse(localStorage.getItem('p_'+curSt) || '{}');
                document.getElementById('stPrivateNote').innerText = p.s ? `Ø¬Ø¯ÙˆÙ„Ùƒ: ${p.s}` : "";
            }
            loadQuiz();

            // Admin View
            document.getElementById('adTeachersList').innerHTML = ts.map(t => `<div class="list-item"><span>${t.n}</span> <button class="btn-del" onclick="delTeacher(${t.id})">Ø­Ø°Ù</button></div>`).join('');
            document.getElementById('adStList').innerHTML = sts.map(s => `<button onclick="openEdit('${s}')">${s}</button> `).join('');
        }

        function loadQuiz() {
            const qs = JSON.parse(localStorage.getItem('qs') || '[]');
            if(qs.length === 0) return;
            const q = qs[qIdx];
            document.getElementById('qText').innerText = q.text;
            document.getElementById('qOpts').innerHTML = q.opts.map((o, i) => `<div class="quiz-opt" id="o_${i}" onclick="selected=${i}">${o}</div>`).join('');
            document.getElementById('nextQBtn').style.display = 'block';
        }

        function nextQuestion() {
            const qs = JSON.parse(localStorage.getItem('qs') || '[]');
            if(selected == qs[qIdx].correct) score++;
            qIdx++; selected = null;
            if(qIdx < qs.length) loadQuiz();
            else { document.getElementById('qContent').style.display='none'; document.getElementById('quizResult').style.display='block'; document.getElementById('resScore').innerText=`Ù†ØªÙŠØ¬ØªÙƒ: ${score}/${qs.length}`; }
        }

        function openEdit(n) { editT = n; document.getElementById('editBox').style.display='block'; document.getElementById('targetSt').innerText=n; }
        function savePrivate() { localStorage.setItem('p_'+editT, JSON.stringify({s: document.getElementById('p_sched').value})); alert("ØªÙ…!"); }
        function changeTheme(t) { document.getElementById('mainBody').className = t; localStorage.setItem('theme', t); }
        function resetQuiz() { qIdx=0; score=0; document.getElementById('qContent').style.display='block'; document.getElementById('quizResult').style.display='none'; loadQuiz(); }

        window.onload = render;
    </script>
</body>
</html>
